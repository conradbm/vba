Private Sub queryByListBoxChoice()

    ' Declare Variables
    Dim frm As Form, ctl As Control
    Dim varItm As Variant
    Dim A_outputString As String
    Dim B_outputString As String
    Dim A_flag As Boolean
    Dim B_flag As Boolean
    
    ' Set Variables

    ' Build A String
    For Each varItm In Forms!Form1!A_LB.ItemsSelected
        A_outputString = A_outputString & 
Forms!Form1!A_LB.ItemData(varItm) & ","
    Next varItm
    
    ' Build B String
    For Each varItm In Forms!Form1!B_LB.ItemsSelected
        B_outputString = B_outputString & 
Forms!Form1!B_LB.ItemData(varItm) & ","
    Next varItm
    
    
    ' Filter A String
    If A_outputString <> "" Then
        'MsgBox (outputString)
        Forms!Form1!A_TB = A_outputString
        A_flag = True
    Else
        'MsgBox ("No input selected")
        A_flag = False
    End If
    
    ' Filter B String
    If B_outputString <> "" Then
        'MsgBox (B_outputString)
        Forms!Form1!B_TB = B_outputString
        B_flag = True
    Else
        'MsgBox ("No input selected")
        B_flag = False
    End If

    ' Decision Making
    If A_flag Then
        'MsgBox ("A_FLAG ON")
    End If
    If B_flag Then
        'MsgBox ("B_FLAG ON")
    End If
    
    
    ' Testing Variables
    Dim outputString As String
    
    ' Database Variables
    Dim rs As DAO.Recordset
    Dim db As DAO.Database
    Dim strSQL As String
    Set db = CurrentDb


    '**** CORRECT SQL QUERY ****'
    '
    ' SELECT T.A
    ' FROM Table1 T
    ' WHERE (((T.A)="1" And (T.A)="2"));
    '
   
    
    ' BUILD AND STATEMENTS
    Dim andStatements As String
    andStatements = "("
    For Each varItm In Forms!Form1!A_LB.ItemsSelected
        andStatements = andStatements & "(T.A)=" & Chr(34) & 
Forms!Form1!A_LB.ItemData(varItm) & Chr(34) & " AND "
    Next varItm
    andStatements = Left(andStatements, Len(andStatements) - 5)
    andStatements = andStatements & ")"
    
    strSQL = "SELECT T.A FROM Table1 T WHERE (" & andStatements & ");"
    Forms!Form1!SQL_TB = strSQL
    
    'Set rs = db.OpenRecordset(strSQL)
    
    Set rs = db.OpenRecordset(strSQL)
    Do While Not rs.EOF
       MsgBox (rs!myField) 'myField is a field name in table myTable
       rs.MoveNext             'press Ctrl+G to see debuG window beneath
    Loop
    
End Sub
